<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Certificate Generator</title>
    <!-- Tailwind CSS library -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Libraries for QR Code, Canvas, and PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* Import a professional font */
        @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Inter:wght@400;500;600;700&family=Dancing+Script:wght@400;700&display=swap');

        body {
            font-family: 'Merriweather', serif;
        }

        /* Custom styles for A4 portrait layout and border design */
        .certificate-a4-portrait {
            width: 210mm;
            height: 297mm;
            background-color: #ffffff;
            border: 8mm solid #0f172a; /* Dark border from the image */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* SVG border corners to replicate the inspiration image */
        .certificate-a4-portrait::before,
        .certificate-a4-portrait::after {
            content: '';
            position: absolute;
            width: 15%; /* Adjust size as needed */
            height: 15%; /* Adjust size as needed */
            background-repeat: no-repeat;
            z-index: 1;
        }
        .certificate-a4-portrait::before {
            top: 0;
            left: 0;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='none' stroke='%23ffffff' stroke-width='4' d='M0,0 L100,0 L100,100 M0,0 L0,100 L100,100'%3E%3C/path%3E%3C/svg%3E");
            background-position: top left;
            transform: scale(1, -1);
        }
        .certificate-a4-portrait::after {
            bottom: 0;
            right: 0;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='none' stroke='%23ffffff' stroke-width='4' d='M0,0 L100,0 L100,100 M0,0 L0,100 L100,100'%3E%3C/path%3E%3C/svg%3E");
            background-position: bottom right;
        }

        .cert-signature-name {
            font-family: 'Dancing Script', cursive;
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        /* Responsive scaling */
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
                height: auto;
                min-height: 100vh;
            }
            .form-container {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
            }
            .preview-container {
                width: 100%;
                height: auto;
                flex-grow: 1;
                padding: 1rem;
            }
            .certificate-a4-portrait {
                width: 100%;
                height: auto;
                padding-bottom: 141.4%; /* Maintain A4 aspect ratio (297/210) */
                border: 1.5vmin solid #0f172a;
            }
            .cert-content-wrapper {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                padding: 2rem;
                box-sizing: border-box;
            }
        }
    </style>
</head>
<body class="bg-gray-100 p-8 flex justify-center items-center min-h-screen">
    <div class="container flex w-full max-w-7xl bg-white rounded-xl shadow-2xl overflow-hidden min-h-[calc(100vh-4rem)]">
        <!-- Form Section -->
        <div class="form-container w-full lg:w-2/5 p-8 bg-gray-50 border-r border-gray-200 overflow-y-auto">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Certificate Details</h2>
            <p class="text-gray-500 text-center mb-8">Enter the information below to generate your certificate.</p>
            
            <div class="space-y-6">
                <label class="block">
                    <span class="text-gray-700 font-medium text-sm">Client Company Name:</span>
                    <input type="text" id="clientName" placeholder="Client Company Name"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50 transition duration-200">
                </label>

                <label class="block">
                    <span class="text-gray-700 font-medium text-sm">Client Website (for QR Code):</span>
                    <input type="text" id="clientWebsite" placeholder="https://company-website.com"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50 transition duration-200">
                </label>

                <label class="block">
                    <span class="text-gray-700 font-medium text-sm">Select Client's Logo:</span>
                    <input type="file" id="clientLogoInput" accept="image/*"
                           class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition duration-200 cursor-pointer">
                </label>
            </div>

            <div class="mt-8">
                <button id="downloadPdf" class="w-full bg-blue-600 text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:bg-blue-700 transition-all duration-300 transform hover:-translate-y-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    Download Certificate as PDF
                </button>
            </div>
        </div>

        <!-- Certificate Preview Section -->
        <div class="preview-container flex-1 flex items-center justify-center p-8 bg-gray-100">
            <div id="certificateContent" class="certificate-a4-portrait rounded-3xl overflow-hidden">
                <div class="cert-content-wrapper relative flex flex-col items-center justify-between p-12 lg:p-16 text-center">
                    <!-- Top Logo -->
                    <div class="w-full mb-8 z-10">
                        <img id="agencyLogo" src="https://educationsimplified.github.io/mgkvp/20250125_115304.png" alt="Agency Logo" class="h-24 w-auto mx-auto object-contain">
                    </div>

                    <!-- Main Content -->
                    <div class="flex-grow flex flex-col justify-center items-center text-center z-10">
                        <h1 class="text-6xl font-bold text-gray-800 tracking-wide uppercase font-serif">CERTIFICATE</h1>
                        
                        <p class="text-lg text-gray-700 italic my-6 leading-relaxed max-w-xl">
                            This certificate is proudly presented by UZAIR B2B SERVICES in appreciation of your support and continued engagement.
                        </p>
                        <p class="text-lg text-gray-700 italic my-6 leading-relaxed max-w-xl">
                            Our website was created with a vision to Help, Empower, and Educate by providing free or highly affordable learning resources.
                        </p>
                        <h3 class="text-4xl font-bold text-gray-900 mt-2 capitalize font-inter">Happy Customer</h3>
                        <p class="text-lg text-gray-700 mt-6 leading-relaxed max-w-xl">
                           We are happy to present this certificate to 
                        </p>
                        <h3 id="previewClientName" class="text-4xl font-bold text-gray-900 mt-2 capitalize font-inter">Client Company Name</h3>
                        <p class="text-lg text-gray-700 mt-6 leading-relaxed max-w-xl">
                            for successfully completing the web development project with us.
                        </p>

                        <div class="w-full mt-8">
                             <div class="h-20 w-auto mx-auto mb-2">
                                <img id="clientLogo" src="https://placehold.co/150x80/292524/ffffff?text=Client+Logo" alt="Client Logo" class="h-full w-auto mx-auto object-contain">
                             </div>
                        </div>

                    </div>

                    <!-- Footer / Signatures -->
                    <div class="flex justify-between items-end w-full mt-12 z-10">
                        <div class="flex flex-col items-center">
                            <span class="cert-signature-name text-gray-900">Uzair Ahmed</span>
                            <div class="h-0.5 w-full bg-gray-500 mt-1"></div>
                            <p class="text-sm font-semibold mt-2 text-gray-700 font-inter">Uzair Ahmed</p>
                            <p class="text-sm text-gray-500 font-inter">UZAIR B2B SERVICES</p>
                        </div>
                        <div id="qrcodeContainer" class="p-4 border border-gray-300 rounded-lg shadow-sm">
                            <div id="qrcode"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let qrcodeInstance = null;
        window.jsPDF = window.jspdf.jsPDF;

        // Elements
        const clientNameInput = document.getElementById('clientName');
        const clientWebsiteInput = document.getElementById('clientWebsite');
        const clientLogoInput = document.getElementById('clientLogoInput');
        const downloadPdfBtn = document.getElementById('downloadPdf');
        const previewClientName = document.getElementById('previewClientName');
        const clientLogoImg = document.getElementById('clientLogo');
        const qrcodeContainer = document.getElementById('qrcode');
        const certificateContent = document.getElementById('certificateContent');

        /**
         * Initializes the certificate preview with default values and sets up event listeners.
         */
        document.addEventListener('DOMContentLoaded', () => {
            updateCertificateName();
            generateQRCode();
            setupEventListeners();
        });

        /**
         * Sets up all necessary event listeners for form inputs and the download button.
         */
        function setupEventListeners() {
            clientNameInput.addEventListener('input', updateCertificateName);
            clientWebsiteInput.addEventListener('input', generateQRCode);
            clientLogoInput.addEventListener('change', handleLogoUpload);
            downloadPdfBtn.addEventListener('click', downloadCertificate);
        }

        /**
         * Updates the client company name on the certificate preview.
         */
        function updateCertificateName() {
            const name = clientNameInput.value || 'Client Company Name';
            previewClientName.textContent = name;
        }

        /**
         * Generates or updates the QR code based on the website URL.
         */
        function generateQRCode() {
            const website = clientWebsiteInput.value;
            // Clear previous QR code
            qrcodeContainer.innerHTML = '';
            
            if (website && website.trim() !== '') {
                qrcodeInstance = new QRCode(qrcodeContainer, {
                    text: website,
                    width: 150, // Increased size
                    height: 150, // Increased size
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
            } else {
                 // Create a placeholder QR code if no website is provided
                 qrcodeInstance = new QRCode(qrcodeContainer, {
                    text: "https://example.com",
                    width: 150, // Increased size
                    height: 150, // Increased size
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
            }
        }

        /**
         * Handles the file upload for the client's logo.
         * @param {Event} event The change event from the file input.
         */
        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    clientLogoImg.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        /**
         * Downloads the certificate as a PDF.
         * This function temporarily adjusts styles for a clean PDF output.
         */
        async function downloadCertificate() {
            // Disable button and show a loading state
            downloadPdfBtn.textContent = "Generating PDF...";
            downloadPdfBtn.disabled = true;
            
            // Temporarily set certificate dimensions for accurate PDF conversion
            const originalWidth = certificateContent.style.width;
            const originalHeight = certificateContent.style.height;
            const originalBorder = certificateContent.style.border;

            certificateContent.style.width = '210mm';
            certificateContent.style.height = '297mm';
            certificateContent.style.border = 'none';
            
            // To properly render the SVG borders on PDF
            const certificateContainer = document.querySelector('.certificate-a4-portrait');
            certificateContainer.style.overflow = 'visible';
            document.querySelector('.cert-content-wrapper').style.padding = '0';


            try {
                // Use html2canvas to capture the certificate as an image
                const canvas = await html2canvas(certificateContent, {
                    scale: 3,
                    backgroundColor: null,
                    useCORS: true
                });
                
                // Get the image data
                const imgData = canvas.toDataURL('image/jpeg', 1.0);

                // Create a new jsPDF instance
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                // Add the captured image to the PDF
                pdf.addImage(imgData, 'JPEG', 0, 0, 210, 297);

                // Save the PDF file
                pdf.save('certificate.pdf');
            } catch (error) {
                console.error("Error generating PDF:", error);
            } finally {
                // Restore original styles and enable the button
                certificateContent.style.width = originalWidth;
                certificateContent.style.height = originalHeight;
                certificateContent.style.border = originalBorder;
                
                certificateContainer.style.overflow = 'hidden';
                document.querySelector('.cert-content-wrapper').style.padding = '';

                downloadPdfBtn.textContent = "Download Certificate as PDF";
                downloadPdfBtn.disabled = false;
            }
        }
    </script>
</body>
</html>
